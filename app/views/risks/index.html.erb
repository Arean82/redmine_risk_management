<%= stylesheet_link_tag 'risks', plugin: 'redmine_risk_management' %>

<div class='contextual'>
  <%= link_to t('label_risks_new'), new_project_risk_path(@project), class: 'icon icon-add' %>
</div>

<h2><%= t('label_risk_plural') %></h2>

<% if @risks.empty? %>
  <p class="nodata"><%= l(:label_no_data) %></p>
<% else %>
  <div class='autoscroll'>
    <table class='list risks'>
      <thead>
        <tr>
          <% risk_table_columns.each do |column| %>
            <th><%= column %></th>
          <% end -%>
          <th><%= t(:label_risks_actions) %></th>
        </tr>
      </thead>

      <tbody>
        <% @risks.each do |risk| %>
          <tr class=<%= cycle('odd', 'even') %>>
            <% risk_table_columns.each do |column| %>
              <td class=<%= column.downcase %>>
                <% if risk_linkable_columns.include?(column) %>
                  <%= link_to risk.send(column.downcase), [@project, risk] %>
                <% else %>
                  <%= risk.send(column.downcase) %>
                <% end -%>
              </td>
            <% end -%>

            <td>
            <% risk.actions.each do |action| %>
              <p><%= link_to "##{action.id}", action %></p>
            <% end -%>
            </td>
          </tr>
        <% end -%>
      </tbody>
    </table>

    <p class='pagination'><%= pagination_links_full @risks_pages, @risks_count %></p>
  </div>

<% end %>
